<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Windows Privilege Escalation | MrJcK</title><meta name=keywords content><meta name=description content="Gathering Stored Credentials We can look for credentials in the system itself and if the found creds have higher integrity we can use it as for privilege escalation and lateral movement.
Searching Password In Stored Files Find Password in File findstr /s /i /n &#34;Search String&#34; *.txt Password can be found in following extension
install, backup, .bak, .log, .bat, .cmd, .vbs, .cnf, .conf, .config, .ini, .xml, .txt, .gpg, .pgp, .p12, ."><meta name=author content><link rel=canonical href=https://mrjck.github.io/posts/windows/windows-privilege-escalation/><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://mrjck.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://mrjck.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://mrjck.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://mrjck.github.io/apple-touch-icon.png><link rel=mask-icon href=https://mrjck.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Windows Privilege Escalation"><meta property="og:description" content="Gathering Stored Credentials We can look for credentials in the system itself and if the found creds have higher integrity we can use it as for privilege escalation and lateral movement.
Searching Password In Stored Files Find Password in File findstr /s /i /n &#34;Search String&#34; *.txt Password can be found in following extension
install, backup, .bak, .log, .bat, .cmd, .vbs, .cnf, .conf, .config, .ini, .xml, .txt, .gpg, .pgp, .p12, ."><meta property="og:type" content="article"><meta property="og:url" content="https://mrjck.github.io/posts/windows/windows-privilege-escalation/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-07-30T21:15:43+03:00"><meta property="article:modified_time" content="2023-07-30T21:15:43+03:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Windows Privilege Escalation"><meta name=twitter:description content="Gathering Stored Credentials We can look for credentials in the system itself and if the found creds have higher integrity we can use it as for privilege escalation and lateral movement.
Searching Password In Stored Files Find Password in File findstr /s /i /n &#34;Search String&#34; *.txt Password can be found in following extension
install, backup, .bak, .log, .bat, .cmd, .vbs, .cnf, .conf, .config, .ini, .xml, .txt, .gpg, .pgp, .p12, ."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://mrjck.github.io/posts/"},{"@type":"ListItem","position":3,"name":"Windows Privilege Escalation","item":"https://mrjck.github.io/posts/windows/windows-privilege-escalation/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Windows Privilege Escalation","name":"Windows Privilege Escalation","description":"Gathering Stored Credentials We can look for credentials in the system itself and if the found creds have higher integrity we can use it as for privilege escalation and lateral movement.\nSearching Password In Stored Files Find Password in File findstr /s /i /n \u0026#34;Search String\u0026#34; *.txt Password can be found in following extension\ninstall, backup, .bak, .log, .bat, .cmd, .vbs, .cnf, .conf, .config, .ini, .xml, .txt, .gpg, .pgp, .p12, .","keywords":[],"articleBody":"Gathering Stored Credentials We can look for credentials in the system itself and if the found creds have higher integrity we can use it as for privilege escalation and lateral movement.\nSearching Password In Stored Files Find Password in File findstr /s /i /n \"Search String\" *.txt Password can be found in following extension\ninstall, backup, .bak, .log, .bat, .cmd, .vbs, .cnf, .conf, .config, .ini, .xml, .txt, .gpg, .pgp, .p12, .der, .csr, .cer, id_rsa, id_dsa, .ovpn, .rdp, vnc, ftp, ssh, vpn, git, .kdbx, .db Find file with name password dir /b /a /s c:\\ \u003e filename.txt type filename.txt | findstr /i password Look for Interesting Files unattend.xml Unattended.xml sysprep.inf sysprep.xml VARIABLES.DAT setupinfo setupinfo.bak web.config SiteList.xml .aws\\credentials .azure\\accessTokens.json .azure\\azureProfile.json gcloud\\credentials.db gcloud\\legacy_credentials gcloud\\access_tokens.db Searching Password In Registry reg query HKLM /f password /t REG_SZ /s reg query HKCU /f password /t REG_SZ /s Getting Password From Credential Manager Find all creds available in Credential Manager\ncmdkey /list To use the creds we can use runas command with /savecred option\nrunas /savecred /user:admin cmd.exe ","wordCount":"171","inLanguage":"en","datePublished":"2023-07-30T21:15:43+03:00","dateModified":"2023-07-30T21:15:43+03:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mrjck.github.io/posts/windows/windows-privilege-escalation/"},"publisher":{"@type":"Organization","name":"MrJcK","logo":{"@type":"ImageObject","url":"https://mrjck.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://mrjck.github.io accesskey=h title="MrJcK (Alt + H)"><img src=https://mrjck.github.io/logo.png alt aria-label=logo height=60>MrJcK</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://mrjck.github.io/myconfig title=MyConfig><span>MyConfig</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://mrjck.github.io>Home</a>&nbsp;»&nbsp;<a href=https://mrjck.github.io/posts/>Posts</a></div><h1 class=post-title>Windows Privilege Escalation</h1><div class=post-meta><span title='2023-07-30 21:15:43 +0300 +03'>July 30, 2023</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;171 words</div></header><div class=post-content><h3 id=gathering-stored-credentials>Gathering Stored Credentials<a hidden class=anchor aria-hidden=true href=#gathering-stored-credentials>#</a></h3><p>We can look for credentials in the system itself and if the found creds have higher integrity we can use it as for privilege escalation and lateral movement.</p><h4 id=searching-password-in-stored-files>Searching Password In Stored Files<a hidden class=anchor aria-hidden=true href=#searching-password-in-stored-files>#</a></h4><ul><li>Find Password in File</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>findstr /s /i /n <span style=color:#e6db74>&#34;Search String&#34;</span> *.txt
</span></span></code></pre></div><p>Password can be found in following extension</p><pre tabindex=0><code>install, backup, .bak, .log, .bat, .cmd, .vbs, .cnf, .conf,
.config, .ini, .xml, .txt, .gpg, .pgp, .p12, .der, .csr, .cer,
id_rsa, id_dsa, .ovpn, .rdp, vnc, ftp, ssh, vpn, git, .kdbx, .db
</code></pre><ul><li>Find file with name password</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cmd data-lang=cmd><span style=display:flex><span><span style=color:#66d9ef>dir</span> /b /a /s c:\ &gt; filename.txt
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cmd data-lang=cmd><span style=display:flex><span><span style=color:#66d9ef>type</span> filename.txt | findstr /i password
</span></span></code></pre></div><ul><li>Look for Interesting Files</li></ul><pre tabindex=0><code>unattend.xml
Unattended.xml
sysprep.inf
sysprep.xml
VARIABLES.DAT
setupinfo
setupinfo.bak
web.config
SiteList.xml
.aws\credentials
.azure\accessTokens.json
.azure\azureProfile.json
gcloud\credentials.db
gcloud\legacy_credentials
gcloud\access_tokens.db
</code></pre><h4 id=searching-password-in-registry>Searching Password In Registry<a hidden class=anchor aria-hidden=true href=#searching-password-in-registry>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cmd data-lang=cmd><span style=display:flex><span>reg query HKLM /f password /t REG_SZ /s
</span></span><span style=display:flex><span>reg query HKCU /f password /t REG_SZ /s
</span></span></code></pre></div><h4 id=getting-password-from-credential-manager>Getting Password From Credential Manager<a hidden class=anchor aria-hidden=true href=#getting-password-from-credential-manager>#</a></h4><p>Find all creds available in Credential Manager</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cmd data-lang=cmd><span style=display:flex><span>cmdkey /list
</span></span></code></pre></div><p>To use the creds we can use runas command with <code>/savecred</code> option</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cmd data-lang=cmd><span style=display:flex><span>runas /savecred /user:admin cmd.exe
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=next href=https://mrjck.github.io/posts/oscp-tool-usage/><span class=title>Next »</span><br><span>OSCP | Tool usage</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://mrjck.github.io>MrJcK</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>